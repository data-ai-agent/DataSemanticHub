# 登录注册功能需求文档 (Login/Register PRD)

## 1. 概述 (Overview)

本此需求旨在完善 DataSemanticHub (数据语义治理平台) 的用户认证体系，涵盖新用户注册、现有用户登录以及单点登录 (SSO) 的基础入口。前端页面已完成设计与开发 (参考 `AuthView.tsx`)，本通过此文档明确后端接口需求及业务逻辑。

## 2. 功能模块 (Modules)

### 2.1 用户注册 (User Registration)

**功能描述**: 允许新用户通过邮箱注册账号，并收集必要的用户信息。

**页面元素**:
- 输入框: 名 (First Name)、姓 (Last Name)
- 输入框: 工作邮箱 (Email)
- 输入框: 团队或公司 (Organization)
- 输入框: 密码 (Password)
- 输入框: 确认密码 (Confirm Password)
- 滑块/复选框: "记住我" (Remember Me - 在注册页通常不适用，但 UI 复用了样式，需确认是否为“同意条款”) -> *UI 显示为 "我同意服务条款与隐私政策"*
- 按钮: "注册账号" (Sign Up)

**业务逻辑**:
1.  **必填校验**: 所有字段均为必填。
2.  **邮箱格式校验**: 必须符合标准邮箱格式。
3.  **密码一致性**: "密码" 与 "确认密码" 必须一致。
4.  **条款同意**: 用户必须勾选 "我同意服务条款与隐私政策" 才能提交。
5.  **提交处理**:
    - 前端提交 JSON 数据至后端注册接口。
    - 后端需校验邮箱是否已被注册。
    - 注册成功后，自动登录并跳转至工作台首页，或跳转至登录页提示查收邮件激活（视安全策略而定，MVP阶段建议直接登录）。

**接口需求**: `POST /api/user/register`

### 2.2 用户登录 (User Login)

**功能描述**: 允许已注册用户通过邮箱和密码登录系统。

**页面元素**:
- 输入框: 工作邮箱 (Email)
- 输入框: 密码 (Password)
- 复选框: "记住我" (Remember Me)
- 链接: "忘记密码？" (Forgot Password?)
- 按钮: "登录" (Login)

**业务逻辑**:
1.  **凭证校验**: 校验邮箱和密码是否匹配。
2.  **记住我**: 若勾选，生成长期有效的 Token 或 Refresh Token。
3.  **错误处理**: 登录失败应提示 "用户名或密码错误"，避免泄露账户是否存在。
4.  **跳转**: 登录成功后跳转至用户之前访问的页面或默认 Dashboard。

**接口需求**: `POST /api/user/login`

### 2.3 单点登录 (Single Sign-On)

**功能描述**: 支持企业内部 SSO 登录。

**页面元素**:
- 按钮: "使用单点登录" (Use Single Sign-On)

**业务逻辑**:
- 点击后重定向至 IDP (Identity Provider) 认证页面或发起 OIDC/SAML 流程。
- *MVP 阶段*: 可先预留接口，或仅做静态展示。

**接口需求**: `GET /api/user/sso/login` (获取重定向地址或直接重定向)

### 2.4 忘记密码 (Forgot Password)

**功能描述**: 找回密码流程。

**页面元素**:
- 链接入口: 登录表单右下角 "忘记密码？"

**业务逻辑**:
- *MVP 阶段*: 点击后可弹窗提示联系管理员，或跳转至简单的邮箱找回页面（需后端发送重置邮件接口支持）。

## 3. 数据字典 (Data Dictionary)

| 字段名 | 类型 | 必填 | 说明 |
| :--- | :--- | :--- | :--- |
| firstName | String | 是 | 用户名 (名) |
| lastName | String | 是 | 用户姓 (姓) |
| email | String | 是 | 登录账号，需唯一 |
| organization | String | 否 | 用户所属组织/团队 |
| password | String | 是 | 需加密存储 (如 bcrypt) |
| rememberMe | Boolean | 否 | 登录选项 |

## 4. 接口定义概览 (API Overview)

| 方法 | 路径 | 描述 |
| :--- | :--- | :--- |
| POST | `/api/user/register` | 用户注册 |
| POST | `/api/user/login` | 用户登录 |
| GET | `/api/user/info` | 获取当前用户信息 (需鉴权) |
| POST | `/api/user/logout` | 退出登录 |

## 5. UI/UX 交互细节

- **输入反馈**: 输入框获得焦点时高亮 (UI 已实现: `focus:ring-2`)。
- **加载状态**: 点击注册/登录后，按钮应进入 Loading 状态，防重复提交。
- **动画**: 页面切换 (登录/注册) 包含平滑过渡动画 (UI 已实现)。
