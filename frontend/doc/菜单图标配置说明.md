# 导航菜单图标配置说明

## 概述

导航菜单的图标配置在 `frontend/src/services/menuTransformService.ts` 文件中，通过 `ICON_MAP` 对象进行映射。

## 配置方式

### 1. 基于菜单 Code 映射（推荐）

图标通过菜单的 `code` 字段进行映射。当后端返回菜单数据时，系统会自动根据菜单的 `code` 查找对应的图标。

**配置文件位置：**
```
frontend/src/services/menuTransformService.ts
```

**配置示例：**
```typescript
const ICON_MAP: Record<string, LucideIcon> = {
    // 数据服务
    'ask_data': MessageCircle,
    'advanced_ask_data': Sparkles,
    'data_supermarket': Search,
    
    // 平台管理
    'org_mgmt': Building2,
    'user_mgmt': UserCog,
    'menu_mgmt': LayoutGrid,
    
    // 默认图标（当找不到匹配时使用）
    'default': Layout,
};
```

### 2. 添加新图标映射

#### 步骤1：导入图标组件

在 `menuTransformService.ts` 文件顶部，从 `lucide-react` 导入需要的图标：

```typescript
import {
    // ... 现有图标
    YourNewIcon,  // 添加新图标
} from 'lucide-react';
```

#### 步骤2：添加到 ICON_MAP

在 `ICON_MAP` 对象中添加映射：

```typescript
const ICON_MAP: Record<string, LucideIcon> = {
    // ... 现有映射
    'your_menu_code': YourNewIcon,  // 添加新映射
};
```

#### 完整示例

假设要为一个新的菜单 `data_analytics`（数据分析）添加图标：

```typescript
// 1. 在文件顶部导入图标
import {
    // ... 现有导入
    BarChart3,  // 新增的图标
} from 'lucide-react';

// 2. 在 ICON_MAP 中添加映射
const ICON_MAP: Record<string, LucideIcon> = {
    // ... 现有映射
    'data_analytics': BarChart3,  // 新增映射
};
```

### 3. 可用的图标库

项目使用 **Lucide React** 图标库，提供了丰富的图标选择。

**常用图标分类：**

- **数据相关**：`Database`, `Table`, `FileText`, `BarChart3`, `PieChart`
- **用户相关**：`User`, `Users`, `UserCog`, `UserPlus`
- **系统相关**：`Settings`, `Cog`, `Shield`, `Lock`, `Key`
- **操作相关**：`Plus`, `Edit`, `Trash2`, `Save`, `Download`, `Upload`
- **导航相关**：`Home`, `Menu`, `Layout`, `Grid`, `List`
- **状态相关**：`CheckCircle`, `XCircle`, `AlertTriangle`, `Info`
- **网络相关**：`Network`, `Link`, `Globe`, `Server`

**查看所有可用图标：**
- 官方文档：https://lucide.dev/icons/
- 搜索图标：在文档中搜索关键词，如 "chart", "user", "settings" 等

### 4. 图标查找逻辑

系统按以下顺序查找图标：

1. **优先使用菜单 code**：`ICON_MAP[menu.code]`
2. **其次使用路径**：从 `menu.path` 提取最后一段，转换为 key 查找
3. **最后使用默认图标**：如果都找不到，使用 `ICON_MAP['default']`（默认是 `Layout`）

**查找函数：**
```typescript
function getMenuIcon(menu: Menu): LucideIcon {
    // 优先使用 code 查找
    if (menu.code && ICON_MAP[menu.code]) {
        return ICON_MAP[menu.code];
    }
    
    // 其次使用 path 查找
    if (menu.path) {
        const pathKey = menu.path.split('/').pop()?.replace(/[-_]/g, '_') || '';
        if (ICON_MAP[pathKey]) {
            return ICON_MAP[pathKey];
        }
    }
    
    // 默认图标
    return ICON_MAP.default || Layout;
}
```

## 配置示例

### 示例1：为新菜单添加图标

假设后端新增了一个菜单，code 为 `report_center`（报表中心）：

```typescript
// 1. 导入图标
import {
    // ... 现有导入
    FileBarChart,  // 报表图标
} from 'lucide-react';

// 2. 添加映射
const ICON_MAP: Record<string, LucideIcon> = {
    // ... 现有映射
    'report_center': FileBarChart,
};
```

### 示例2：修改现有菜单图标

如果要修改 `org_mgmt` 的图标：

```typescript
// 1. 导入新图标
import {
    // ... 现有导入
    Building,  // 新图标（如果还没有导入）
} from 'lucide-react';

// 2. 修改映射
const ICON_MAP: Record<string, LucideIcon> = {
    // ... 其他映射
    'org_mgmt': Building,  // 从 Building2 改为 Building
};
```

### 示例3：为多个相似菜单使用相同图标

```typescript
const ICON_MAP: Record<string, LucideIcon> = {
    // 多个报表相关菜单使用相同图标
    'report_list': FileBarChart,
    'report_detail': FileBarChart,
    'report_export': FileBarChart,
};
```

## 最佳实践

1. **使用语义化图标**：选择与菜单功能相关的图标
   - ✅ 用户管理 → `UserCog`
   - ✅ 数据源管理 → `Database`
   - ❌ 用户管理 → `Database`（不相关）

2. **保持一致性**：相似功能的菜单使用相似风格的图标
   - 管理类菜单：`Settings`, `Cog`, `UserCog`
   - 数据类菜单：`Database`, `Table`, `FileText`
   - 分析类菜单：`BarChart3`, `PieChart`, `TrendingUp`

3. **使用默认图标**：对于不确定的菜单，可以暂时不配置，系统会使用默认图标

4. **图标命名**：使用菜单的 `code` 作为 key，保持与后端一致

## 常见问题

### Q1: 如何知道菜单的 code 是什么？

A: 可以通过以下方式查看：
1. 在菜单管理页面查看菜单的编码
2. 查看后端返回的菜单数据中的 `code` 字段
3. 查看浏览器开发者工具中的网络请求

### Q2: 找不到合适的图标怎么办？

A: 
1. 访问 https://lucide.dev/icons/ 搜索关键词
2. 使用相近功能的图标
3. 暂时使用默认图标 `Layout`

### Q3: 图标不显示怎么办？

A: 检查以下几点：
1. 图标是否已从 `lucide-react` 导入
2. `ICON_MAP` 中的 key 是否与菜单的 `code` 完全匹配（大小写敏感）
3. 浏览器控制台是否有错误信息

### Q4: 可以自定义图标吗？

A: 当前系统使用 Lucide React 图标库。如果需要自定义图标：
1. 可以创建自定义 SVG 图标组件
2. 在 `ICON_MAP` 中使用自定义组件
3. 确保组件符合 `LucideIcon` 类型要求

## 相关文件

- **图标映射配置**：`frontend/src/services/menuTransformService.ts`
- **图标库文档**：https://lucide.dev/
- **菜单服务**：`frontend/src/services/menuService.ts`
- **菜单配置**：`frontend/src/config/menuConfig.ts`

## 更新日志

- 2025-01-26: 初始版本，支持基于 code 的图标映射
